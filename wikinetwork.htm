<!DOCTYPE html>
<meta charset="utf-8">
<html>
	<head>
		<link rel="stylesheet" type="text/css" href="wikinetwork.css" media="screen" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	  <script src="https://d3js.org/d3.v4.min.js"></script>
	  <script src="force_directed_network.js"></script>
 		<script>
				function fetchGraph(title, hops, branches) {
					var urlParams = "?title=" + title + "&hops=" + hops + "&branches=" + branches;
					var apiUrl = "/fetch_graph" + urlParams;
					console.log(title);
					$.ajax({url: apiUrl,
						error: function (error) {
							console.error(error);
						},
						success: function (res) {
							var svg = d3.select("svg");
							initD3(svg);
							displayGraph(svg, res);
						}
					});
				}

				function handleSearch() {
					var title = $("#searchField").val();
          var hops = $("#hopsField").val();
          var branches = $("#branchesField").val();
					fetchGraph(title, hops, branches);
				}

				function handleCenter() {
					var selectedTitle = $("#nodename").text().substring(6);
					$("#searchField").val(selectedTitle);
					handleSearch();
				}
		</script>

	</head>

    <body>


		<!-- Sidebar -->
		<div class="sidebar">
		  <a href="#about">About</a>
		  <a href="#nodeinfo">Node Info</a>
		    <BLOCKQUOTE id="nodename"> </BLOCKQUOTE>
		    <BLOCKQUOTE id="nodeurl"> </BLOCKQUOTE>
		    <BLOCKQUOTE id="nodecategories"> </BLOCKQUOTE>
		    <BLOCKQUOTE id="nodedescription"> </BLOCKQUOTE>
		  <a><button type="button" class="btn btn-default" onclick="handleDelete()">Delete Node</button></a>
			<a><button type="button" onclick = "handleCenter()">Center Node</button></a>
		</div>
		<!-- /sidebar-->


		<div class="main">
		  <h3>Welcome to WikiNetwork</h3>
		  <form action = "http://127.0.0.1:3000/clear" method = "GET">
			 <input type = "submit" value = "Clear Graph">
		  </form>

		  <p>Please enter a Wikipedia subject in the field and click Search</p>
			<p>For example, search for "computer science" with 5 branches and 2 hops.</p>
      <p>Then click on the nodes that appear to see info about them.<p>
			<button onclick="handleSearch()" type="button">Search</button>
			<input id="searchField" type="text">
      <label for="branchesField">Branches:</label>
      <input id="branchesField" value="5" min="1" max="10" type="number">
      <label for="hopsField">Hops:</label>
      <input id="hopsField" value="1" min="1" max="3" type="number">

			<p>Search for a node that's in the already loaded graph.</p>
			<button onclick="handleNodeSearch()" type="button">Node Search</button>
			<input id="nodeSearchField" type="text">
		</div>
		<svg id="viewport" width="960" height="600"></svg>

    </body>
</html>
